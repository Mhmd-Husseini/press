(()=>{var e={};e.id=913,e.ids=[913],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},79428:e=>{"use strict";e.exports=require("buffer")},55511:e=>{"use strict";e.exports=require("crypto")},33873:e=>{"use strict";e.exports=require("path")},27910:e=>{"use strict";e.exports=require("stream")},79551:e=>{"use strict";e.exports=require("url")},28354:e=>{"use strict";e.exports=require("util")},39631:(e,r,s)=>{"use strict";s.r(r),s.d(r,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>o,routeModule:()=>m,tree:()=>d});var a=s(70260),t=s(28203),i=s(25155),n=s.n(i),l=s(67292),c={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);s.d(r,c);let d=["",{children:["admin",{children:["users",{children:["[id]",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,58562)),"D:\\press\\src\\app\\admin\\users\\[id]\\page.tsx"]}]},{}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,85798)),"D:\\press\\src\\app\\admin\\layout.tsx"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,71354)),"D:\\press\\src\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,19937,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(s.t.bind(s,69116,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(s.t.bind(s,41485,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["D:\\press\\src\\app\\admin\\users\\[id]\\page.tsx"],u={require:s,loadChunk:()=>Promise.resolve()},m=new a.AppPageRouteModule({definition:{kind:t.RouteKind.APP_PAGE,page:"/admin/users/[id]/page",pathname:"/admin/users/[id]",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},51580:(e,r,s)=>{"use strict";s.r(r),s.d(r,{"007ef74b69aebf12238ea651195ddc937e58ae17f8":()=>a.HW,"00d4248e5cc13d9a24c27da7f63c4e748a633f8d0d":()=>a.ri,"4050a74c93af136bf3a3faa21dd4a4d846bc6cf489":()=>a.kz,"406c6ae9fdbd8fde4bc076808d36b31662aa903d10":()=>x,"4088416fcca4e2f0fd31c02635f52bcd85eb0c7428":()=>N,"408e655556292a0a94341763d8193fda605da02beb":()=>a.iD,"40bfc4f08e4990765ebb050f59da905b6a735b35b7":()=>v,"40d9017b028a04aceb55dc0703bb229a5931508547":()=>g,"70bcc105acf56993e9fa771860505741269129801f":()=>f});var a=s(90119),t=s(21590);s(70376);var i=s(16500),n=s(47735);class l{constructor(e){this.query={},this.searchFields=[],this.searchFields=e}paginate(e){let r=Number(e.page)||1,s=Number(e.limit)||10;return{take:s,skip:(r-1)*s}}sort(e){return e.sortBy?{orderBy:{[e.sortBy]:e.sortOrder||"desc"}}:{}}search(e){return e.search?{OR:this.searchFields.map(r=>({[r]:{contains:e.search,mode:"insensitive"}}))}:{}}filter(e){return e.filters?{AND:Object.entries(e.filters).map(([e,r])=>({[e]:r}))}:{}}build(e){return{where:{...this.search(e),...this.filter(e)},...this.paginate(e),...this.sort(e)}}}class c{constructor(e,r,s){this.prisma=e,this.model=r,this.searchFields=s}async findAll(e){let r=new l(this.searchFields).build(e),[s,a]=await Promise.all([this.model.findMany(r),this.model.count({where:r.where})]);return{data:s,meta:{total:a,page:Number(e.page)||1,limit:Number(e.limit)||10,totalPages:Math.ceil(a/(Number(e.limit)||10))}}}}var d=s(80541),o=s(10267);class u extends c{constructor(){super(d.A,d.A.user,["email","firstName","lastName","firstNameArabic","lastNameArabic"].map(e=>`${e}`))}async create(e,r=["USER"]){if(await this.prisma.user.findUnique({where:{email:e.email}}))throw Error("User with this email already exists");let s=await o.Ay.hash(e.password,10);return this.prisma.user.create({data:{...e,password:s,roles:{create:r.map(e=>({role:{connectOrCreate:{where:{name:e},create:{name:e}}}}))}},include:{roles:{include:{role:!0}}}})}async findById(e){return this.prisma.user.findUnique({where:{id:e},include:{roles:{include:{role:!0}}}})}async update(e,r,s){r.password&&(r.password=await o.Ay.hash(r.password,10));let a=await this.prisma.user.update({where:{id:e},data:r,include:{roles:{include:{role:!0}}}});return s&&s.length>0?(await this.prisma.userRole.deleteMany({where:{userId:e}}),await Promise.all(s.map(async r=>{let s=await this.prisma.role.findUnique({where:{name:r}});if(s)return this.prisma.userRole.create({data:{userId:e,roleId:s.id}})})),this.prisma.user.findUnique({where:{id:e},include:{roles:{include:{role:!0}}}})):a}async delete(e){return await this.prisma.userRole.deleteMany({where:{userId:e}}),this.prisma.user.delete({where:{id:e}})}}var m=s(99344);let p=i.z.object({email:i.z.string().email(),firstName:i.z.string().min(1),lastName:i.z.string().min(1),password:i.z.string().min(6),languagePreference:i.z.string().optional(),firstNameArabic:i.z.string().optional(),lastNameArabic:i.z.string().optional(),bioArabic:i.z.string().optional(),bio:i.z.string().optional(),avatar:i.z.string().optional(),isActive:i.z.boolean().optional().default(!0)}),h=p.partial().omit({password:!0}).extend({id:i.z.string(),password:i.z.string().min(6).optional()}),b=new u;async function x(e){try{let r={email:e.get("email"),firstName:e.get("firstName"),lastName:e.get("lastName"),password:e.get("password"),firstNameArabic:e.get("firstNameArabic"),lastNameArabic:e.get("lastNameArabic"),bio:e.get("bio"),bioArabic:e.get("bioArabic"),avatar:e.get("avatar"),languagePreference:e.get("languagePreference"),isActive:"true"===e.get("isActive")},s=p.parse(r),a=e.get("roles"),t=a?a.split(","):["USER"],{password:i,...l}=await b.create(s,t);return(0,n.revalidatePath)("/admin/users"),{success:!0,user:l}}catch(e){if(console.error("Error creating user:",e),e instanceof i.z.ZodError)return{success:!1,error:e.errors.map(e=>e.message).join(", ")};return{success:!1,error:e instanceof Error?e.message:"Failed to create user"}}}async function f(e=1,r=10,s){try{let a=await b.findAll({page:e,limit:r,search:s,sortBy:"createdAt",sortOrder:"desc"}),t=a.data.map(e=>{let{password:r,...s}=e;return s});return{success:!0,users:t,meta:a.meta}}catch(e){return console.error("Error getting users:",e),{success:!1,error:"Failed to retrieve users"}}}async function g(e){try{let r=await b.findById(e);if(!r)return{success:!1,error:"User not found"};let{password:s,...a}=r;return{success:!0,user:a}}catch(e){return console.error("Error getting user:",e),{success:!1,error:"Failed to retrieve user"}}}async function v(e){try{let r=e.get("id");if(!r)return{success:!1,error:"User ID is required"};if(!await b.findById(r))return{success:!1,error:"User not found"};let s={id:r,email:e.get("email"),firstName:e.get("firstName"),lastName:e.get("lastName"),password:e.get("password")||void 0,firstNameArabic:e.get("firstNameArabic"),lastNameArabic:e.get("lastNameArabic"),bio:e.get("bio"),bioArabic:e.get("bioArabic"),avatar:e.get("avatar"),languagePreference:e.get("languagePreference"),isActive:"true"===e.get("isActive")},{id:a,...t}=h.parse(s),i={...t};void 0===i.password&&delete i.password;let l=e.get("roles"),c=l?l.split(","):void 0,{password:d,...o}=await b.update(r,i,c);return(0,n.revalidatePath)("/admin/users"),(0,n.revalidatePath)(`/admin/users/${r}`),{success:!0,user:o}}catch(e){if(console.error("Error updating user:",e),e instanceof i.z.ZodError)return{success:!1,error:e.errors.map(e=>e.message).join(", ")};return{success:!1,error:"Failed to update user"}}}async function N(e){try{return await b.delete(e),(0,n.revalidatePath)("/admin/users"),{success:!0}}catch(e){return console.error("Error deleting user:",e),{success:!1,error:"Failed to delete user"}}}(0,m.D)([x,f,g,v,N]),(0,t.A)(x,"406c6ae9fdbd8fde4bc076808d36b31662aa903d10",null),(0,t.A)(f,"70bcc105acf56993e9fa771860505741269129801f",null),(0,t.A)(g,"40d9017b028a04aceb55dc0703bb229a5931508547",null),(0,t.A)(v,"40bfc4f08e4990765ebb050f59da905b6a735b35b7",null),(0,t.A)(N,"4088416fcca4e2f0fd31c02635f52bcd85eb0c7428",null)},74189:(e,r,s)=>{Promise.resolve().then(s.bind(s,58562))},37805:(e,r,s)=>{Promise.resolve().then(s.bind(s,14325))},14325:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>o});var a=s(45512),t=s(26248);t.callServer,t.findSourceMapURL;var i=s(28531),n=s.n(i),l=s(79334),c=s(84824),d=s(58009);function o({params:e}){e.id;let[r,s]=(0,d.useState)(null),[t,i]=(0,d.useState)(!0),[o,u]=(0,d.useState)(null),m=(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-8 rounded-lg text-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Access Denied"}),(0,a.jsx)("p",{className:"mt-2",children:"You don't have permission to view user details."}),(0,a.jsx)(n(),{href:"/admin",className:"mt-4 inline-block text-blue-600 hover:underline",children:"Return to Admin Dashboard"})]});return t?(0,a.jsx)("div",{className:"text-center py-8",children:"Loading user information..."}):o||!r?(0,l.notFound)():(0,a.jsx)(c.A,{roles:["SUPER_ADMIN","EDITOR_IN_CHIEF","EDITORIAL","SENIOR_EDITOR"],fallback:m,children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"User Details"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)(c.A,{roles:["SUPER_ADMIN","EDITOR_IN_CHIEF","EDITORIAL"],children:(0,a.jsx)(n(),{href:`/admin/users/${r.id}/edit`,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Edit User"})}),(0,a.jsx)(n(),{href:"/admin/users",className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"Back to Users"})]})]}),(0,a.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Basic Information"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Email"}),(0,a.jsx)("span",{className:"font-medium",children:r.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Name"}),(0,a.jsxs)("span",{className:"font-medium",children:[r.firstName," ",r.lastName]})]}),(r.firstNameArabic||r.lastNameArabic)&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Name (Arabic)"}),(0,a.jsxs)("span",{className:"font-medium",children:[r.firstNameArabic," ",r.lastNameArabic]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Status"}),(0,a.jsx)("span",{className:`inline-block px-2 py-1 text-xs font-medium rounded-full ${r.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r.isActive?"Active":"Inactive"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Language Preference"}),(0,a.jsx)("span",{className:"font-medium",children:"ar"===r.languagePreference?"Arabic":"English"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Roles & Dates"}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Roles"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:r.roles&&r.roles.map((e,r)=>(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:e.role.name},r))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Created At"}),(0,a.jsx)("span",{className:"font-medium",children:new Date(r.createdAt).toLocaleString()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Last Updated"}),(0,a.jsx)("span",{className:"font-medium",children:new Date(r.updatedAt).toLocaleString()})]}),r.lastLogin&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm",children:"Last Login"}),(0,a.jsx)("span",{className:"font-medium",children:new Date(r.lastLogin).toLocaleString()})]})]})]})]}),(r.bio||r.bioArabic)&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Biography"}),r.bio&&(0,a.jsxs)("div",{className:"mb-4",children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm mb-1",children:"English"}),(0,a.jsx)("p",{className:"text-gray-700 bg-gray-50 p-3 rounded",children:r.bio})]}),r.bioArabic&&(0,a.jsxs)("div",{children:[(0,a.jsx)("span",{className:"text-gray-500 block text-sm mb-1",children:"Arabic"}),(0,a.jsx)("p",{className:"text-gray-700 bg-gray-50 p-3 rounded",children:r.bioArabic})]})]}),r.avatar&&(0,a.jsxs)("div",{className:"mt-8",children:[(0,a.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Avatar"}),(0,a.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:(0,a.jsx)("img",{src:r.avatar,alt:`${r.firstName} ${r.lastName}`,className:"w-full h-full object-cover"})})]})]})]})})}},84824:(e,r,s)=>{"use strict";s.d(r,{A:()=>i});var a=s(45512);s(58009);var t=s(20438);function i({roles:e,type:r="any",fallback:s=null,children:i}){let{user:n,loading:l}=(0,t.A)(),c=Array.isArray(e)?e:[e];return l?null:n&&n.roles?("all"===r?c.every(e=>n.roles.includes(e)):c.some(e=>n.roles.includes(e)))?(0,a.jsx)(a.Fragment,{children:i}):(0,a.jsx)(a.Fragment,{children:s}):(0,a.jsx)(a.Fragment,{children:s})}},58562:(e,r,s)=>{"use strict";s.r(r),s.d(r,{default:()=>a});let a=(0,s(46760).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\press\\\\src\\\\app\\\\admin\\\\users\\\\[id]\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\press\\src\\app\\admin\\users\\[id]\\page.tsx","default")}};var r=require("../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),a=r.X(0,[638,6154,3928,2367,4549,7735,574],()=>s(39631));module.exports=a})();