(()=>{var e={};e.id=3952,e.ids=[3952],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{"use strict";e.exports=require("crypto")},44561:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>w,routeModule:()=>p,serverHooks:()=>f,workAsyncStorage:()=>l,workUnitAsyncStorage:()=>m});var s={};t.r(s),t.d(s,{DELETE:()=>c});var a=t(42706),o=t(28203),n=t(45994),i=t(39187),d=t(84908),u=t(63957);async function c(e,{params:r}){try{let e=r.id,t=await d.default.media.findUnique({where:{id:e}});if(!t)return i.NextResponse.json({error:"Media not found"},{status:404});await d.default.media.delete({where:{id:e}});try{await (0,u.e)(t.url)}catch(e){console.error("Failed to delete file from S3:",e)}return i.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting media:",e),i.NextResponse.json({error:"Failed to delete media"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:o.RouteKind.APP_ROUTE,page:"/api/media/[id]/route",pathname:"/api/media/[id]",filename:"route",bundlePath:"app/api/media/[id]/route"},resolvedPagePath:"D:\\press\\src\\app\\api\\media\\[id]\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:l,workUnitAsyncStorage:m,serverHooks:f}=p;function w(){return(0,n.patchFetch)({workAsyncStorage:l,workUnitAsyncStorage:m})}},96487:()=>{},78335:()=>{},84908:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>o,prisma:()=>a});var s=t(96330);let a=global.prisma||new s.PrismaClient({log:["query","error","warn"]}),o=a},63957:(e,r,t)=>{"use strict";t.d(r,{e:()=>u,h:()=>d});let s=require("@aws-sdk/client-s3");var a=t(55511);let o=new s.S3Client({region:process.env.AWS_DEFAULT_REGION,credentials:{accessKeyId:process.env.AWS_ACCESS_KEY_ID,secretAccessKey:process.env.AWS_SECRET_ACCESS_KEY}}),n=process.env.AWS_BUCKET,i=process.env.AWS_URL;async function d(e,r=""){let t=e.name.split(".").pop()||"",u=`${r?`${r}/`:""}${(0,a.randomUUID)()}.${t}`,c=await e.arrayBuffer(),p={Bucket:n,Key:u,Body:Buffer.from(c),ContentType:e.type};try{return await o.send(new s.PutObjectCommand(p)),`${i}/${u}`}catch(e){throw console.error("Error uploading to S3:",e),e}}async function u(e){let r=e.replace(`${i}/`,"");try{await o.send(new s.DeleteObjectCommand({Bucket:n,Key:r}))}catch(e){throw console.error("Error deleting from S3:",e),e}}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,5452],()=>t(44561));module.exports=s})();