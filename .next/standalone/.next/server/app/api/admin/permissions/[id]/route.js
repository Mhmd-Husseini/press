"use strict";(()=>{var e={};e.id=3496,e.ids=[3496],e.modules={96330:e=>{e.exports=require("@prisma/client")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{e.exports=require("crypto")},4573:e=>{e.exports=require("node:buffer")},77598:e=>{e.exports=require("node:crypto")},57975:e=>{e.exports=require("node:util")},5919:(e,r,s)=>{s.r(r),s.d(r,{patchFetch:()=>j,routeModule:()=>x,serverHooks:()=>w,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>y});var i={};s.r(i),s.d(i,{DELETE:()=>f,GET:()=>c,PUT:()=>l});var n=s(42706),t=s(28203),o=s(45994),a=s(39187),p=s(28009),u=s(60399);let d=new p.n,m=new u.u;async function c(e,{params:r}){try{if(!await m.hasPermission("view_permissions"))return a.NextResponse.json({error:"Unauthorized: Insufficient permissions"},{status:403});let e=await d.findById(r.id);if(!e)return a.NextResponse.json({error:"Permission not found"},{status:404});return a.NextResponse.json(e)}catch(e){return console.error("Error fetching permission:",e),a.NextResponse.json({error:"Failed to fetch permission"},{status:500})}}async function l(e,{params:r}){try{if(!await m.hasPermission("edit_permissions"))return a.NextResponse.json({error:"Unauthorized: Insufficient permissions"},{status:403});let s=await e.json();if(!s.name)return a.NextResponse.json({error:"Permission name is required"},{status:400});if(!await d.findById(r.id))return a.NextResponse.json({error:"Permission not found"},{status:404});let i=await d.update(r.id,{name:s.name,nameArabic:s.nameArabic,description:s.description,descriptionArabic:s.descriptionArabic});return a.NextResponse.json(i)}catch(e){return console.error("Error updating permission:",e),a.NextResponse.json({error:"Failed to update permission"},{status:500})}}async function f(e,{params:r}){try{if(!await m.hasPermission("delete_permissions"))return a.NextResponse.json({error:"Unauthorized: Insufficient permissions"},{status:403});if(!await d.findById(r.id))return a.NextResponse.json({error:"Permission not found"},{status:404});return await d.delete(r.id),a.NextResponse.json({success:!0})}catch(e){return console.error("Error deleting permission:",e),a.NextResponse.json({error:"Failed to delete permission"},{status:500})}}let x=new n.AppRouteRouteModule({definition:{kind:t.RouteKind.APP_ROUTE,page:"/api/admin/permissions/[id]/route",pathname:"/api/admin/permissions/[id]",filename:"route",bundlePath:"app/api/admin/permissions/[id]/route"},resolvedPagePath:"D:\\press\\src\\app\\api\\admin\\permissions\\[id]\\route.ts",nextConfigOutput:"standalone",userland:i}),{workAsyncStorage:h,workUnitAsyncStorage:y,serverHooks:w}=x;function j(){return(0,o.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:y})}},28009:(e,r,s)=>{s.d(r,{n:()=>t});var i=s(22565),n=s(84908);class t extends i.d{constructor(){super(n.default,n.default.permission,[])}async create(e){if(await this.prisma.permission.findUnique({where:{name:e.name}}))throw Error(`Permission '${e.name}' already exists`);return this.prisma.permission.create({data:e})}async findByName(e){return this.prisma.permission.findUnique({where:{name:e}})}async findById(e){return this.prisma.permission.findUnique({where:{id:e}})}async getAll(){return this.prisma.permission.findMany({orderBy:{name:"asc"}})}async update(e,r){return this.prisma.permission.update({where:{id:e},data:r})}async delete(e){return await this.prisma.rolePermission.deleteMany({where:{permissionId:e}}),this.prisma.permission.delete({where:{id:e}})}}}};var r=require("../../../../../webpack-runtime.js");r.C(e);var s=e=>r(r.s=e),i=r.X(0,[638,5452,4512,4926,7031,5371],()=>s(5919));module.exports=i})();