(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[913],{6155:(e,s,a)=>{Promise.resolve().then(a.bind(a,5726))},6046:(e,s,a)=>{"use strict";var r=a(6658);a.o(r,"notFound")&&a.d(s,{notFound:function(){return r.notFound}}),a.o(r,"useParams")&&a.d(s,{useParams:function(){return r.useParams}}),a.o(r,"usePathname")&&a.d(s,{usePathname:function(){return r.usePathname}}),a.o(r,"useRouter")&&a.d(s,{useRouter:function(){return r.useRouter}}),a.o(r,"useSearchParams")&&a.d(s,{useSearchParams:function(){return r.useSearchParams}})},5828:(e,s,a)=>{"use strict";Object.defineProperty(s,"__esModule",{value:!0}),function(e,s){for(var a in s)Object.defineProperty(e,a,{enumerable:!0,get:s[a]})}(s,{callServer:function(){return r.callServer},createServerReference:function(){return l},findSourceMapURL:function(){return t.findSourceMapURL}});let r=a(9603),t=a(3355),l=a(4979).createServerReference},5726:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>u});var r=a(5155),t=a(5828);let l=(0,t.createServerReference)("40d9017b028a04aceb55dc0703bb229a5931508547",t.callServer,void 0,t.findSourceMapURL,"getUserById");var n=a(8173),c=a.n(n),i=a(6046),d=a(1330),o=a(2115);function u(e){let{params:s}=e,a=s.id,[t,n]=(0,o.useState)(null),[u,m]=(0,o.useState)(!0),[x,h]=(0,o.useState)(null);(0,o.useEffect)(()=>{!async function(){try{m(!0);let e=await l(a);if(!e.success||!e.user){h("User not found");return}n(e.user)}catch(e){h("Failed to load user"),console.error(e)}finally{m(!1)}}()},[a]);let f=(0,r.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-6 py-8 rounded-lg text-center",children:[(0,r.jsx)("h3",{className:"text-lg font-medium",children:"Access Denied"}),(0,r.jsx)("p",{className:"mt-2",children:"You don't have permission to view user details."}),(0,r.jsx)(c(),{href:"/admin",className:"mt-4 inline-block text-blue-600 hover:underline",children:"Return to Admin Dashboard"})]});return u?(0,r.jsx)("div",{className:"text-center py-8",children:"Loading user information..."}):x||!t?(0,i.notFound)():(0,r.jsx)(d.A,{roles:["SUPER_ADMIN","EDITOR_IN_CHIEF","EDITORIAL","SENIOR_EDITOR"],fallback:f,children:(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h1",{className:"text-2xl font-bold",children:"User Details"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)(d.A,{roles:["SUPER_ADMIN","EDITOR_IN_CHIEF","EDITORIAL"],children:(0,r.jsx)(c(),{href:"/admin/users/".concat(t.id,"/edit"),className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Edit User"})}),(0,r.jsx)(c(),{href:"/admin/users",className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-md hover:bg-gray-300 transition-colors",children:"Back to Users"})]})]}),(0,r.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,r.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Basic Information"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Email"}),(0,r.jsx)("span",{className:"font-medium",children:t.email})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Name"}),(0,r.jsxs)("span",{className:"font-medium",children:[t.firstName," ",t.lastName]})]}),(t.firstNameArabic||t.lastNameArabic)&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Name (Arabic)"}),(0,r.jsxs)("span",{className:"font-medium",children:[t.firstNameArabic," ",t.lastNameArabic]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Status"}),(0,r.jsx)("span",{className:"inline-block px-2 py-1 text-xs font-medium rounded-full ".concat(t.isActive?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:t.isActive?"Active":"Inactive"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Language Preference"}),(0,r.jsx)("span",{className:"font-medium",children:"ar"===t.languagePreference?"Arabic":"English"})]})]})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Roles & Dates"}),(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Roles"}),(0,r.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:t.roles&&t.roles.map((e,s)=>(0,r.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full bg-blue-100 text-blue-800",children:e.role.name},s))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Created At"}),(0,r.jsx)("span",{className:"font-medium",children:new Date(t.createdAt).toLocaleString()})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Last Updated"}),(0,r.jsx)("span",{className:"font-medium",children:new Date(t.updatedAt).toLocaleString()})]}),t.lastLogin&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm",children:"Last Login"}),(0,r.jsx)("span",{className:"font-medium",children:new Date(t.lastLogin).toLocaleString()})]})]})]})]}),(t.bio||t.bioArabic)&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Biography"}),t.bio&&(0,r.jsxs)("div",{className:"mb-4",children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm mb-1",children:"English"}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-3 rounded",children:t.bio})]}),t.bioArabic&&(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-gray-500 block text-sm mb-1",children:"Arabic"}),(0,r.jsx)("p",{className:"text-gray-700 bg-gray-50 p-3 rounded",children:t.bioArabic})]})]}),t.avatar&&(0,r.jsxs)("div",{className:"mt-8",children:[(0,r.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Avatar"}),(0,r.jsx)("div",{className:"w-24 h-24 rounded-full overflow-hidden",children:(0,r.jsx)("img",{src:t.avatar,alt:"".concat(t.firstName," ").concat(t.lastName),className:"w-full h-full object-cover"})})]})]})]})})}},1330:(e,s,a)=>{"use strict";a.d(s,{A:()=>l});var r=a(5155);a(2115);var t=a(5202);function l(e){let{roles:s,type:a="any",fallback:l=null,children:n}=e,{user:c,loading:i}=(0,t.A)(),d=Array.isArray(s)?s:[s];return i?null:c&&c.roles?("all"===a?d.every(e=>c.roles.includes(e)):d.some(e=>c.roles.includes(e)))?(0,r.jsx)(r.Fragment,{children:n}):(0,r.jsx)(r.Fragment,{children:l}):(0,r.jsx)(r.Fragment,{children:l})}},5202:(e,s,a)=>{"use strict";a.d(s,{AuthProvider:()=>d,A:()=>i});var r=a(5155),t=a(2115),l=a(5828);let n=(0,l.createServerReference)("00d4248e5cc13d9a24c27da7f63c4e748a633f8d0d",l.callServer,void 0,l.findSourceMapURL,"logout"),c=(0,t.createContext)(void 0);function i(){let e=(0,t.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function d(e){let{children:s}=e,[a,l]=(0,t.useState)(null),[i,d]=(0,t.useState)(!0),[o,u]=(0,t.useState)(null),m=(0,t.useCallback)(async()=>{try{u(null);let e=await fetch("/api/auth/me",{credentials:"include",cache:"no-store"});if(e.ok)return await e.json();if(401===e.status)return null;throw Error("Failed to fetch user data")}catch(e){return console.error("Failed to load user:",e),u(e instanceof Error?e.message:"Failed to load user"),null}},[]),x=(0,t.useCallback)(async()=>{l(await m())},[m]);(0,t.useEffect)(()=>{let e=!0;return(async()=>{let s=await m();e&&(l(s),d(!1))})(),()=>{e=!1}},[m]);let h=(0,t.useCallback)(e=>!!a&&(!!(a.roles.includes("ADMIN")||a.roles.includes("SUPER_ADMIN"))||a.permissions.includes(e)),[a]),f=(0,t.useCallback)(e=>e.some(e=>h(e)),[h]),b=(0,t.useCallback)(e=>e.every(e=>h(e)),[h]),g=(0,t.useCallback)(async()=>{try{u(null),await n(),l(null),window.location.href="/admin/login"}catch(e){console.error("Logout failed:",e),u(e instanceof Error?e.message:"Logout failed")}},[]),j=t.useMemo(()=>({user:a,loading:i,error:o,setUser:l,hasPermission:h,hasAnyPermissions:f,hasAllPermissions:b,logout:g,refreshUser:x}),[a,i,o,h,f,b,g,x]);return(0,r.jsx)(c.Provider,{value:j,children:s})}}},e=>{var s=s=>e(e.s=s);e.O(0,[8173,8441,1517,7358],()=>s(6155)),_N_E=e.O()}]);