(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2116],{577:(e,r,a)=>{Promise.resolve().then(a.bind(a,9947))},6046:(e,r,a)=>{"use strict";var t=a(6658);a.o(t,"notFound")&&a.d(r,{notFound:function(){return t.notFound}}),a.o(t,"useParams")&&a.d(r,{useParams:function(){return t.useParams}}),a.o(t,"usePathname")&&a.d(r,{usePathname:function(){return t.usePathname}}),a.o(t,"useRouter")&&a.d(r,{useRouter:function(){return t.useRouter}}),a.o(t,"useSearchParams")&&a.d(r,{useSearchParams:function(){return t.useSearchParams}})},5828:(e,r,a)=>{"use strict";Object.defineProperty(r,"__esModule",{value:!0}),function(e,r){for(var a in r)Object.defineProperty(e,a,{enumerable:!0,get:r[a]})}(r,{callServer:function(){return t.callServer},createServerReference:function(){return s},findSourceMapURL:function(){return n.findSourceMapURL}});let t=a(9603),n=a(3355),s=a(4979).createServerReference},9947:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>i});var t=a(5155),n=a(2115),s=a(5828);let o=(0,s.createServerReference)("408e655556292a0a94341763d8193fda605da02beb",s.callServer,void 0,s.findSourceMapURL,"login");var l=a(7650),u=a(6046),c=a(5202);function d(){let{pending:e}=(0,l.useFormStatus)();return(0,t.jsx)("button",{type:"submit",disabled:e,className:"w-full py-2 px-4 bg-blue-600 hover:bg-blue-700 disabled:bg-blue-400 text-white font-bold rounded-lg transition-colors",children:e?"Logging in...":"Login"})}function i(){let[e,r]=(0,n.useState)(null),[a,s]=(0,n.useState)("");(0,u.useRouter)();let l=(0,u.useSearchParams)(),{setUser:i}=(0,c.A)();async function m(e){r(null),s("");try{let a=await o(e);if(!a.success){r("string"==typeof a.error?a.error:"Login failed. Please check your credentials.");return}a.user&&i(a.user);let t=l.get("callbackUrl"),n=t?decodeURIComponent(t):"/admin";s("Login successful! Redirecting to: ".concat(n)),setTimeout(()=>{window.location.href=n},1500)}catch(e){console.error("Login error:",e),r("An unexpected error occurred. Please try again.")}}return(0,t.jsx)("div",{className:"flex items-center justify-center min-h-screen py-12 px-4 sm:px-6 lg:px-8",children:(0,t.jsxs)("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Admin Login"}),(0,t.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Sign in to access the admin panel"})]}),(0,t.jsxs)("form",{className:"mt-8 space-y-6",action:m,children:[e&&(0,t.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4",children:e}),a&&(0,t.jsx)("div",{className:"bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded mb-4",children:a}),(0,t.jsxs)("div",{className:"rounded-md shadow-sm -space-y-px",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"email",className:"sr-only",children:"Email address"}),(0,t.jsx)("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"password",className:"sr-only",children:"Password"}),(0,t.jsx)("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),(0,t.jsx)("div",{children:(0,t.jsx)(d,{})})]})]})})}},5202:(e,r,a)=>{"use strict";a.d(r,{AuthProvider:()=>c,A:()=>u});var t=a(5155),n=a(2115),s=a(5828);let o=(0,s.createServerReference)("00d4248e5cc13d9a24c27da7f63c4e748a633f8d0d",s.callServer,void 0,s.findSourceMapURL,"logout"),l=(0,n.createContext)(void 0);function u(){let e=(0,n.useContext)(l);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:r}=e,[a,s]=(0,n.useState)(null),[u,c]=(0,n.useState)(!0),[d,i]=(0,n.useState)(null),m=(0,n.useCallback)(async()=>{try{i(null);let e=await fetch("/api/auth/me",{credentials:"include",cache:"no-store"});if(e.ok)return await e.json();if(401===e.status)return null;throw Error("Failed to fetch user data")}catch(e){return console.error("Failed to load user:",e),i(e instanceof Error?e.message:"Failed to load user"),null}},[]),f=(0,n.useCallback)(async()=>{s(await m())},[m]);(0,n.useEffect)(()=>{let e=!0;return(async()=>{let r=await m();e&&(s(r),c(!1))})(),()=>{e=!1}},[m]);let h=(0,n.useCallback)(e=>!!a&&(!!(a.roles.includes("ADMIN")||a.roles.includes("SUPER_ADMIN"))||a.permissions.includes(e)),[a]),p=(0,n.useCallback)(e=>e.some(e=>h(e)),[h]),b=(0,n.useCallback)(e=>e.every(e=>h(e)),[h]),x=(0,n.useCallback)(async()=>{try{i(null),await o(),s(null),window.location.href="/admin/login"}catch(e){console.error("Logout failed:",e),i(e instanceof Error?e.message:"Logout failed")}},[]),g=n.useMemo(()=>({user:a,loading:u,error:d,setUser:s,hasPermission:h,hasAnyPermissions:p,hasAllPermissions:b,logout:x,refreshUser:f}),[a,u,d,h,p,b,x,f]);return(0,t.jsx)(l.Provider,{value:g,children:r})}}},e=>{var r=r=>e(e.s=r);e.O(0,[8441,1517,7358],()=>r(577)),_N_E=e.O()}]);