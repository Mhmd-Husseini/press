(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9556],{450:(e,t,r)=>{Promise.resolve().then(r.bind(r,6750))},6046:(e,t,r)=>{"use strict";var a=r(6658);r.o(a,"notFound")&&r.d(t,{notFound:function(){return a.notFound}}),r.o(a,"useParams")&&r.d(t,{useParams:function(){return a.useParams}}),r.o(a,"usePathname")&&r.d(t,{usePathname:function(){return a.usePathname}}),r.o(a,"useRouter")&&r.d(t,{useRouter:function(){return a.useRouter}}),r.o(a,"useSearchParams")&&r.d(t,{useSearchParams:function(){return a.useSearchParams}})},5828:(e,t,r)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{callServer:function(){return a.callServer},createServerReference:function(){return s},findSourceMapURL:function(){return n.findSourceMapURL}});let a=r(9603),n=r(3355),s=r(4979).createServerReference},6750:(e,t,r)=>{"use strict";r.d(t,{default:()=>h});var a=r(5155),n=r(2115),s=r(6046),l=r(8173),i=r.n(l);let o=n.forwardRef(function(e,t){let{title:r,titleId:a,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))});var c=r(6214),d=r(57),u=r(1567),m=r(5202);function h(){let e=(0,s.useRouter)(),t=(0,s.useSearchParams)(),{user:r}=(0,m.A)(),[l,h]=(0,n.useState)([]),[g,x]=(0,n.useState)([]),[f,p]=(0,n.useState)(!0),[b,y]=(0,n.useState)(null),[v,j]=(0,n.useState)({page:1,limit:10,total:0,pages:0}),w=t.get("category"),N=parseInt(t.get("page")||"1"),k=parseInt(t.get("limit")||"10"),S=t.get("search")||"";(0,n.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/admin/categories?flat=true");if(!e.ok)throw Error("Failed to fetch categories");let t=await e.json();h(t)}catch(e){console.error("Error fetching categories:",e),y("Failed to load categories")}})()},[]);let E=async()=>{p(!0),x([]);try{let e="/api/admin/posts",t=new URLSearchParams({page:N.toString(),limit:k.toString(),...w&&{categoryId:w},...S&&{search:S}});e+="?".concat(t.toString());let r=await fetch(e);if(!r.ok)throw Error("Failed to fetch posts");let a=await r.json();x(a.posts||[]),j({page:a.page||N,limit:a.limit||k,total:a.total||0,pages:a.pages||0}),y(null)}catch(e){console.error("Error fetching posts:",e),y("Failed to load posts")}finally{p(!1)}};(0,n.useEffect)(()=>{E()},[w,N,k,S]);let P=r=>{let a=new URLSearchParams(t);r?a.set("category",r):a.delete("category"),a.set("page","1"),e.push("/admin/content?".concat(a.toString()))},C=e=>{let t=e.translations.find(e=>"en"===e.locale),r=e.translations[0];return(null==t?void 0:t.title)||(null==r?void 0:r.title)||"Untitled Post"},R=e=>{switch(e){case"PUBLISHED":return"bg-green-100 text-green-800";case"DRAFT":case"ARCHIVED":default:return"bg-gray-100 text-gray-800";case"PENDING_REVIEW":return"bg-yellow-100 text-yellow-800";case"UNDER_REVIEW":return"bg-blue-100 text-blue-800";case"APPROVED":return"bg-purple-100 text-purple-800";case"DECLINED":return"bg-red-100 text-red-800"}},A=e=>{switch(e){case"PUBLISHED":return"Published";case"DRAFT":return"Draft";case"PENDING_REVIEW":return"Pending Review";case"UNDER_REVIEW":return"Under Review";case"APPROVED":return"Approved";case"DECLINED":return"Declined";case"ARCHIVED":return"Archived";default:return e}},D=e=>{if(e.authorName)return e.authorName;if(!e.author)return"Unknown";if("name"in e.author&&"string"==typeof e.author.name&&e.author.name)return e.author.name;let t=e.author.firstName||"",r=e.author.lastName||"";return t||r?"".concat(t," ").concat(r).trim():"Unknown"},L=[{key:"translations",label:"Title",sortable:!0,render:(e,t)=>(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"text-sm font-medium text-gray-900",children:(0,u.EJ)(C(t),50)}),t.featured&&(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-indigo-100 text-indigo-800 mt-1",children:"Featured"})]})},{key:"status",label:"Status",render:e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(R(e)),children:A(e)})},{key:"category",label:"Category",render:(e,t)=>{var r,n;return(0,a.jsx)("span",{className:"text-sm text-gray-500",children:(null===(n=t.category)||void 0===n?void 0:null===(r=n.translations[0])||void 0===r?void 0:r.name)||"Uncategorized"})}},{key:"author",label:"Author",render:(e,t)=>(0,a.jsx)("span",{className:"text-sm text-gray-500",children:D(t)})},{key:"updatedAt",label:"Date",sortable:!0,render:e=>(0,a.jsx)("span",{className:"text-sm text-gray-500",children:(0,u.Yq)(e)})},{key:"id",label:"Actions",className:"text-right",render:(e,t)=>{var r;return(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(i(),{href:"/admin/posts/".concat(t.id,"/edit"),className:"text-indigo-600 hover:text-indigo-900 text-sm font-medium",children:"Edit"}),(0,a.jsx)(i(),{href:"/posts/".concat((null===(r=t.translations[0])||void 0===r?void 0:r.slug)||t.id),className:"text-gray-600 hover:text-gray-900 text-sm font-medium",target:"_blank",children:"View"})]})}}];return(0,a.jsxs)("div",{className:"py-6 space-y-6",children:[(0,a.jsx)(d.default,{title:"Content Management",description:"Manage all your posts and articles",actions:[{label:"New Post",href:w?"/admin/posts/new?category=".concat(w):"/admin/posts/new",icon:(0,a.jsx)(o,{className:"h-4 w-4"}),variant:"primary"}]}),(0,a.jsxs)("div",{className:"flex flex-col lg:flex-row gap-6",children:[(0,a.jsx)("div",{className:"w-full lg:w-64 flex-shrink-0",children:(0,a.jsxs)("div",{className:"bg-white shadow-sm rounded-lg overflow-hidden",children:[(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Filter by Category"})}),(0,a.jsx)("nav",{className:"p-2",children:(0,a.jsxs)("ul",{className:"space-y-1",children:[(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>P(),className:"w-full text-left px-3 py-2 text-sm rounded-md transition-colors ".concat(w?"text-gray-700 hover:bg-gray-50":"bg-indigo-50 text-indigo-700 font-medium"),children:"All Posts"})}),l.map(e=>{var t;return(0,a.jsx)("li",{children:(0,a.jsx)("button",{onClick:()=>P(e.id),className:"w-full text-left px-3 py-2 text-sm rounded-md transition-colors ".concat(w===e.id?"bg-indigo-50 text-indigo-700 font-medium":"text-gray-700 hover:bg-gray-50"),children:(null===(t=e.translations[0])||void 0===t?void 0:t.name)||"Unnamed Category"})},e.id)})]})})]})}),(0,a.jsxs)("div",{className:"flex-1",children:[b&&(0,a.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:b}),(0,a.jsx)(c.b,{columns:L,data:g,total:v.total,page:v.page,limit:v.limit,onPageChange:r=>{let a=new URLSearchParams(t);a.set("page",r.toString()),e.push("/admin/content?".concat(a.toString()))},onLimitChange:r=>{let a=new URLSearchParams(t);a.set("limit",r.toString()),a.set("page","1"),e.push("/admin/content?".concat(a.toString()))},onSearch:r=>{let a=new URLSearchParams(t);r?a.set("search",r):a.delete("search"),a.set("page","1"),e.push("/admin/content?".concat(a.toString()))},loading:f,searchPlaceholder:"Search posts by title or content..."})]})]})]})}},57:(e,t,r)=>{"use strict";r.d(t,{default:()=>o});var a=r(5155),n=r(2115),s=r(8173),l=r.n(s),i=r(8277);function o(e){let{title:t,description:r,buttonText:s,buttonHref:o,buttonPermission:c,buttonAction:d,actions:u}=e,m=s&&(o||d),h=e=>{let t="ml-3 inline-flex items-center px-4 py-2 border rounded-md shadow-sm text-sm font-medium focus:outline-none focus:ring-2 focus:ring-offset-2";switch(e){case"secondary":return"".concat(t," border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-indigo-500");case"danger":return"".concat(t," border-transparent bg-red-600 text-white hover:bg-red-700 focus:ring-red-500");default:return"".concat(t," border-transparent bg-indigo-600 text-white hover:bg-indigo-700 focus:ring-indigo-500")}},g=(0,a.jsx)("button",{onClick:d,className:h(),children:s}),x=(0,a.jsx)(l(),{href:o||"#",className:h(),children:s});return(0,a.jsxs)("div",{className:"md:flex md:items-center md:justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsx)("h2",{className:"text-2xl font-bold leading-7 text-gray-900 sm:text-3xl sm:truncate",children:t}),r&&(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:r})]}),(0,a.jsxs)("div",{className:"mt-4 flex md:mt-0 md:ml-4",children:[m&&c?(0,a.jsx)(i.A,{permissions:c,children:o?x:g}):m&&(o?x:g),u&&u.map((e,t)=>{let r=(0,a.jsx)(n.Fragment,{children:e.href?(0,a.jsxs)(l(),{href:e.href,className:h(e.variant),children:[e.icon&&(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]}):(0,a.jsxs)("button",{onClick:e.onClick,className:h(e.variant),children:[e.icon&&(0,a.jsx)("span",{className:"mr-2",children:e.icon}),e.label]})},t);return e.permission?(0,a.jsx)(i.A,{permissions:e.permission,children:r},t):r})]})]})}},8277:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});var a=r(5155);r(2115);var n=r(5202);function s(e){let{permissions:t,type:r="any",fallback:s=null,children:l}=e,{hasPermission:i,hasAllPermissions:o,hasAnyPermissions:c,loading:d}=(0,n.A)(),u=Array.isArray(t)?t:[t];return d?null:("all"===r?o(u):c(u))?(0,a.jsx)(a.Fragment,{children:l}):(0,a.jsx)(a.Fragment,{children:s})}},6214:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});var a=r(5155),n=r(2115),s=r(7721);let l=n.forwardRef(function(e,t){let{title:r,titleId:a,...s}=e;return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":a},s),r?n.createElement("title",{id:a},r):null,n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))});var i=r(6441);function o(e){let{columns:t,data:r,total:o,page:c,limit:d,onPageChange:u,onLimitChange:m,onSort:h,onSearch:g,onFilter:x,loading:f=!1,searchPlaceholder:p="Search..."}=e,[b,y]=(0,n.useState)(null),[v,j]=(0,n.useState)("asc"),[w,N]=(0,n.useState)(""),k=e=>{let t=b===e&&"asc"===v?"desc":"asc";y(e),j(t),null==h||h(e,t)},S=e=>{N(e),null==g||g(e)},E=Math.ceil(o/d),P=Math.min(c*d,o);return(0,a.jsxs)("div",{className:"bg-white shadow rounded-lg",children:[g&&(0,a.jsx)("div",{className:"p-4 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"relative max-w-md",children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:(0,a.jsx)(s.A,{className:"h-5 w-5 text-gray-400"})}),(0,a.jsx)("input",{type:"text",placeholder:p,value:w,onChange:e=>S(e.target.value),className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})]})}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,a.jsx)("thead",{className:"bg-gray-50",children:(0,a.jsx)("tr",{children:t.map(e=>(0,a.jsx)("th",{onClick:()=>e.sortable&&k(e.key),className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider ".concat(e.sortable?"cursor-pointer hover:bg-gray-100":""," ").concat(e.className||""),children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{children:e.label}),e.sortable&&(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(l,{className:"h-3 w-3 ".concat(b===e.key&&"asc"===v?"text-indigo-600":"text-gray-300")}),(0,a.jsx)(i.A,{className:"h-3 w-3 -mt-1 ".concat(b===e.key&&"desc"===v?"text-indigo-600":"text-gray-300")})]})]})},String(e.key)))})}),(0,a.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:f?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:t.length,className:"px-6 py-12 text-center",children:(0,a.jsx)("div",{className:"flex justify-center",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-indigo-600"})})})}):0===r.length?(0,a.jsx)("tr",{children:(0,a.jsx)("td",{colSpan:t.length,className:"px-6 py-12 text-center text-gray-500",children:"No data found"})}):r.map((e,r)=>(0,a.jsx)("tr",{className:"hover:bg-gray-50",children:t.map(t=>(0,a.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:t.render?t.render(e[t.key],e):String(e[t.key]||"")},String(t.key)))},r))})]})}),(0,a.jsxs)("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[(0,a.jsxs)("div",{className:"flex-1 flex justify-between sm:hidden",children:[(0,a.jsx)("button",{onClick:()=>u(c-1),disabled:c<=1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),(0,a.jsx)("button",{onClick:()=>u(c+1),disabled:c>=E,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]}),(0,a.jsxs)("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("p",{className:"text-sm text-gray-700",children:["Showing ",(0,a.jsx)("span",{className:"font-medium",children:(c-1)*d+1})," to"," ",(0,a.jsx)("span",{className:"font-medium",children:P})," of"," ",(0,a.jsx)("span",{className:"font-medium",children:o})," results"]}),(0,a.jsxs)("select",{value:d,onChange:e=>m(Number(e.target.value)),className:"border border-gray-300 rounded-md text-sm px-2 py-1 focus:outline-none focus:ring-1 focus:ring-indigo-500 focus:border-indigo-500",children:[(0,a.jsx)("option",{value:10,children:"10 per page"}),(0,a.jsx)("option",{value:25,children:"25 per page"}),(0,a.jsx)("option",{value:50,children:"50 per page"}),(0,a.jsx)("option",{value:100,children:"100 per page"})]})]}),(0,a.jsx)("div",{children:(0,a.jsxs)("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[(0,a.jsx)("button",{onClick:()=>u(c-1),disabled:c<=1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),E>1&&(()=>{let e=[],t=[];for(let t=Math.max(2,c-2);t<=Math.min(E-1,c+2);t++)e.push(t);return c-2>2?t.push(1,"..."):t.push(1),t.push(...e),c+2<E-1?t.push("...",E):t.push(E),t})().map((e,t)=>"..."===e?(0,a.jsx)("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:"..."},t):(0,a.jsx)("button",{onClick:()=>u(e),className:"relative inline-flex items-center px-4 py-2 border text-sm font-medium ".concat(c===e?"z-10 bg-indigo-50 border-indigo-500 text-indigo-600":"bg-white border-gray-300 text-gray-500 hover:bg-gray-50"),children:e},t)),(0,a.jsx)("button",{onClick:()=>u(c+1),disabled:c>=E,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})})]})]})]})}},5202:(e,t,r)=>{"use strict";r.d(t,{AuthProvider:()=>c,A:()=>o});var a=r(5155),n=r(2115),s=r(5828);let l=(0,s.createServerReference)("00d4248e5cc13d9a24c27da7f63c4e748a633f8d0d",s.callServer,void 0,s.findSourceMapURL,"logout"),i=(0,n.createContext)(void 0);function o(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function c(e){let{children:t}=e,[r,s]=(0,n.useState)(null),[o,c]=(0,n.useState)(!0),[d,u]=(0,n.useState)(null),m=(0,n.useCallback)(async()=>{try{u(null);let e=await fetch("/api/auth/me",{credentials:"include",cache:"no-store"});if(e.ok)return await e.json();if(401===e.status)return null;throw Error("Failed to fetch user data")}catch(e){return console.error("Failed to load user:",e),u(e instanceof Error?e.message:"Failed to load user"),null}},[]),h=(0,n.useCallback)(async()=>{s(await m())},[m]);(0,n.useEffect)(()=>{let e=!0;return(async()=>{let t=await m();e&&(s(t),c(!1))})(),()=>{e=!1}},[m]);let g=(0,n.useCallback)(e=>!!r&&(!!(r.roles.includes("ADMIN")||r.roles.includes("SUPER_ADMIN"))||r.permissions.includes(e)),[r]),x=(0,n.useCallback)(e=>e.some(e=>g(e)),[g]),f=(0,n.useCallback)(e=>e.every(e=>g(e)),[g]),p=(0,n.useCallback)(async()=>{try{u(null),await l(),s(null),window.location.href="/admin/login"}catch(e){console.error("Logout failed:",e),u(e instanceof Error?e.message:"Logout failed")}},[]),b=n.useMemo(()=>({user:r,loading:o,error:d,setUser:s,hasPermission:g,hasAnyPermissions:x,hasAllPermissions:f,logout:p,refreshUser:h}),[r,o,d,g,x,f,p,h]);return(0,a.jsx)(i.Provider,{value:b,children:t})}},1567:(e,t,r)=>{"use strict";r.d(t,{EJ:()=>i,Yq:()=>l,bT:()=>c,cn:()=>s,tr:()=>o});var a=r(3463),n=r(9795);function s(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.QP)((0,a.$)(t))}function l(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-US";if(!e)return"";let r="string"==typeof e?new Date(e):e;return isNaN(r.getTime())?"":r.toLocaleDateString(t,{year:"numeric",month:"long",day:"numeric"})}function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return!e||e.length<=t?e||"":e.substring(0,t).trim()+"..."}let o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en",r=new Date(e);return new Intl.DateTimeFormat("ar"===t?"ar-AE":"en-US",{year:"numeric",month:"long",day:"numeric"}).format(r)},c=function(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"en",a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"name";if(!e||0===e.length)return;let n=e.find(e=>e.locale===t);if(n)return n[a];let s=e.find(e=>e.locale===r);return s?s[a]:e[0][a]}},6441:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2115);let n=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))})},7721:(e,t,r)=>{"use strict";r.d(t,{A:()=>n});var a=r(2115);let n=a.forwardRef(function(e,t){let{title:r,titleId:n,...s}=e;return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":n},s),r?a.createElement("title",{id:n},r):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))})}},e=>{var t=t=>e(e.s=t);e.O(0,[8173,1181,8441,1517,7358],()=>t(450)),_N_E=e.O()}]);