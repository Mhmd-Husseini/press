"use strict";(()=>{var e={};e.id=6215,e.ids=[6215],e.modules={96330:e=>{e.exports=require("@prisma/client")},10846:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},55511:e=>{e.exports=require("crypto")},4573:e=>{e.exports=require("node:buffer")},77598:e=>{e.exports=require("node:crypto")},57975:e=>{e.exports=require("node:util")},33159:(e,t,r)=>{r.r(t),r.d(t,{patchFetch:()=>v,routeModule:()=>m,serverHooks:()=>f,workAsyncStorage:()=>h,workUnitAsyncStorage:()=>x});var o={};r.r(o),r.d(o,{GET:()=>l,POST:()=>g});var s=r(42706),n=r(28203),a=r(45994),i=r(39187),u=r(65220),d=r(60399);let p=new u.K,c=new d.u;async function l(e){try{if(!await c.hasPermission(e,"view_content"))return i.NextResponse.json({error:"Unauthorized"},{status:403});let t=await c.getUserFromRequest(e);if(!t)return i.NextResponse.json({error:"Unauthorized - User not found"},{status:401});let{searchParams:r}=new URL(e.url),o=r.get("status"),s=r.get("locale"),n=r.get("categoryId")||r.get("category"),a=r.get("authorId")||r.get("author"),u=r.has("featured")?"true"===r.get("featured"):void 0,d=r.get("tag"),l=r.get("search"),g=r.has("page")?parseInt(r.get("page")||"1",10):1,m=r.has("limit")?parseInt(r.get("limit")||"10",10):10,h=t.roles||[];h.some(e=>e.role?.name==="SUPER_ADMIN"||e.role?.name==="EDITOR_IN_CHIEF"||e.role?.name==="EDITORIAL"),h.some(e=>e.role?.name==="SENIOR_EDITOR"),h.some(e=>e.role?.name==="EDITOR");let x=await p.getAll({status:o||void 0,locale:s||void 0,categoryId:n||void 0,authorId:a||void 0,page:g||void 0,limit:m||void 0,search:l||void 0,tag:d||void 0,featured:u});return i.NextResponse.json(x)}catch(e){return console.error("Error fetching posts:",e),i.NextResponse.json({error:"Failed to fetch posts"},{status:500})}}async function g(e){try{if(console.log("Starting post creation process..."),console.log("Checking user permission for create_content..."),!await c.hasPermission(e,"create_content"))return console.log("Permission denied: create_content"),i.NextResponse.json({error:"Unauthorized - No permission to create content"},{status:403});console.log("Permission granted: create_content"),console.log("Getting user from request...");let t=await c.getUserFromRequest(e);if(!t)return console.log("Failed to get user from request"),i.NextResponse.json({error:"Unauthorized - User not found"},{status:401});console.log("User found:",t.id,t.email);let r=await e.json();if(console.log("Parsed request data:",JSON.stringify(r,null,2)),!r.postAuthorId)return i.NextResponse.json({error:"postAuthorId is required"},{status:400});r.authorId||(r.authorId=t.id,console.log("Using current user as author:",t.id)),r.createdById=t.id,r.updatedById=t.id,console.log("Setting creator and updater to current user:",t.id),console.log("Creating post...");let o=await p.create(r);return console.log("Post created successfully with ID:",o.id),i.NextResponse.json(o,{status:201})}catch(e){return console.error("Error creating post:",e),i.NextResponse.json({error:e.message||"Failed to create post",stack:void 0},{status:400})}}let m=new s.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/posts/route",pathname:"/api/admin/posts",filename:"route",bundlePath:"app/api/admin/posts/route"},resolvedPagePath:"D:\\press\\src\\app\\api\\admin\\posts\\route.ts",nextConfigOutput:"standalone",userland:o}),{workAsyncStorage:h,workUnitAsyncStorage:x,serverHooks:f}=m;function v(){return(0,a.patchFetch)({workAsyncStorage:h,workUnitAsyncStorage:x})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,5452,4512,4926,7031,5371,5220],()=>r(33159));module.exports=o})();