(()=>{var e={};e.id=9716,e.ids=[9716],e.modules={96330:e=>{"use strict";e.exports=require("@prisma/client")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},84502:(e,t,r)=>{"use strict";r.r(t),r.d(t,{patchFetch:()=>w,routeModule:()=>f,serverHooks:()=>m,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>g});var s={};r.r(s),r.d(s,{DELETE:()=>h,GET:()=>p,PUT:()=>c});var o=r(42706),n=r(28203),a=r(45994),i=r(39187),u=r(84908),d=r(30379);let l=d.z.object({nameEn:d.z.string().min(1,"English name is required"),nameAr:d.z.string().optional(),country:d.z.string().optional(),bio:d.z.string().optional(),bioAr:d.z.string().optional(),avatar:d.z.string().optional(),email:d.z.string().email().optional().or(d.z.literal("")),socialLinks:d.z.record(d.z.string()).optional(),isActive:d.z.boolean().optional()});async function p(e,{params:t}){try{let e=await u.default.author.findUnique({where:{id:t.id,deletedAt:null},include:{posts:{select:{id:!0,status:!0,translations:{select:{title:!0,locale:!0}},publishedAt:!0,createdAt:!0},orderBy:{createdAt:"desc"}},_count:{select:{posts:!0}}}});if(!e)return i.NextResponse.json({error:"Author not found"},{status:404});return i.NextResponse.json(e)}catch(e){return console.error("Error fetching author:",e),i.NextResponse.json({error:"Failed to fetch author"},{status:500})}}async function c(e,{params:t}){try{let r=await e.json(),s=l.parse(r);if(!await u.default.author.findUnique({where:{id:t.id,deletedAt:null}}))return i.NextResponse.json({error:"Author not found"},{status:404});if(await u.default.author.findFirst({where:{nameEn:s.nameEn,id:{not:t.id},deletedAt:null}}))return i.NextResponse.json({error:"Author with this English name already exists"},{status:400});let o=await u.default.author.update({where:{id:t.id},data:s,include:{_count:{select:{posts:!0}}}});return i.NextResponse.json(o)}catch(e){if(console.error("Error updating author:",e),e instanceof d.z.ZodError)return i.NextResponse.json({error:"Validation error",details:e.errors},{status:400});return i.NextResponse.json({error:"Failed to update author"},{status:500})}}async function h(e,{params:t}){try{let e=await u.default.author.findUnique({where:{id:t.id,deletedAt:null},include:{_count:{select:{posts:!0}}}});if(!e)return i.NextResponse.json({error:"Author not found"},{status:404});if(e._count.posts>0)return i.NextResponse.json({error:"Cannot delete author with existing posts. Please reassign posts first.",postsCount:e._count.posts},{status:400});return await u.default.author.update({where:{id:t.id},data:{deletedAt:new Date}}),i.NextResponse.json({message:"Author deleted successfully"},{status:200})}catch(e){return console.error("Error deleting author:",e),i.NextResponse.json({error:"Failed to delete author"},{status:500})}}let f=new o.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/admin/authors/[id]/route",pathname:"/api/admin/authors/[id]",filename:"route",bundlePath:"app/api/admin/authors/[id]/route"},resolvedPagePath:"D:\\press\\src\\app\\api\\admin\\authors\\[id]\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:g,serverHooks:m}=f;function w(){return(0,a.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:g})}},96487:()=>{},78335:()=>{},84908:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>n,prisma:()=>o});var s=r(96330);let o=global.prisma||new s.PrismaClient({log:["query","error","warn"]}),n=o}};var t=require("../../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,5452,379],()=>r(84502));module.exports=s})();